---
title: "Extracting a dataset about of climate variables in Lis"
author: "Antony Barja"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette Title}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

In this vignettes you might to learn like to use  some functions about of the Malaria Hydrobasin project to extract a dataset about of climate variables.

The main functions are: 

 - `get_climate`
 - `get_etp`
 - `get_ghm`
 - `get_pop`
 - `get_urban`
 - `get_ndvi`
 - `get_evi`
 - `get_savi`
 - `get_ndvi`

This functions taking some dataset of Google Earth Engine, this are of next: 

```{r echo=FALSE,message=FALSE}
library(tidyverse)
library(kableExtra)
read_csv('../files/dataset_ee.csv') %>% 
  kable()
  
```


Remember that you can use this functions only if you have a count in **Google Earth Engine**, if you don't have a count , you could register in this [link]()


## Extract dataset about climate 
In this case we going to use the function `get_climate`, the first step is install the packages lis, rgee and tidyverse. 

The first step is active your count of Google Earth Engine using the function ee_Initialize()

```{r ,message=FALSE}

library(lis)
library(rgee)
library(sf)
library(tidyverse)
library(leaflet)
library(cptcity)
ee_Initialize()

```

To extract the data set is necessary to have an objective polygon

```{r}
amazonas <- import_db('Peru_shp') %>% 
  filter(reg == 'AMAZONAS') %>% 
  select(distr)

```


```{r}
amazonas_ro <- getClimate(year = 2019,
                          bands = 'ro',
                          region = amazonas,
                          fun = 'mean') 
head(amazonas_ro)
```


# Visualization of ro

```{r, echo=FALSE , fig.align='center'}
amazonas_ro %>% 
  ggplot() + 
  geom_sf(aes(fill = tmax2019)) + 
  theme_minimal() + 
  scale_fill_gradient(low = 'white',high = 'red')
```
